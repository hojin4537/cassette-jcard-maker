# 카세트 테이프 에디터 PRD (Product Requirements Document)

## 1. 프로젝트 개요

### 1.1 제품명
카세트 테이프 에디터 (Cassette Maker)

### 1.2 제품 목적
카세트 테이프용 J카드와 라벨 스티커를 디자인하고 고해상도 이미지로 출력할 수 있는 웹 기반 에디터

### 1.3 타겟 사용자
- 카세트 테이프를 제작하는 음악가 및 아티스트
- DIY 카세트 테이프를 만드는 취미 활동가
- 소규모 레이블 및 인디 음악 제작자

### 1.4 핵심 가치 제안
- 전문적인 인쇄 품질 (300 DPI)
- 정확한 치수 계산 (Bleed 포함)
- 직관적인 단계별 위저드 인터페이스
- 이미지 기반 자동 색상 추출 및 대비 최적화

---

## 2. 기능 요구사항

### 2.1 템플릿 선택

#### 2.1.1 기능 설명
사용자가 J카드 또는 라벨 스티커 중 하나를 선택하여 시작

#### 2.1.2 상세 요구사항
- **템플릿 타입**
  - J카드: 카세트 테이프 케이스에 삽입되는 종이 커버
  - 라벨 스티커: 카세트 테이프 본체에 붙이는 스티커
- **UI 구성**
  - 템플릿 카드 그리드 레이아웃
  - 각 템플릿에 아이콘, 이름, 타입 표시
  - 클릭 시 해당 에디터로 이동

#### 2.1.3 사용자 플로우
1. 메인 화면에서 템플릿 선택
2. J카드 선택 → J카드 위저드 시작
3. 라벨 스티커 선택 → 라벨 에디터 시작

---

### 2.2 J카드 위저드

#### 2.2.1 개요
3단계 위저드 방식으로 J카드를 제작 (Cover → Spine → Flap → Preview)

#### 2.2.2 Step 1: Cassette Cover

**기능**
- 메인 이미지 업로드
- 앨범 이름 입력
- 폰트 설정 (패밀리, 크기, 굵기)
- 텍스트 색상 선택

**상세 요구사항**
- **이미지 업로드**
  - 단일 이미지 파일 업로드 지원
  - 이미지 미리보기 제공
  - 이미지에서 주요 색상 자동 추출
  - 추출된 색상 기반 텍스트 색상 추천
- **텍스트 설정**
  - 앨범 이름 필수 입력
  - 폰트 패밀리 선택 (Arial, Times New Roman 등)
  - 폰트 크기 조절 (기본값: 32px)
  - 폰트 굵기 선택 (normal, bold, 300-700)
  - 텍스트 색상 선택 (색상 피커 + 추천 색상)
- **실시간 미리보기**
  - 이미지와 텍스트 오버레이 실시간 표시
  - 텍스트는 중앙 하단 배치
  - 텍스트 그림자 효과 적용
- **검증**
  - 이미지와 앨범 이름이 모두 입력되어야 다음 단계 진행 가능

**기술 사양**
- 이미지 비율 유지하며 cover-fit 방식으로 표시
- Bleed 영역(0.5cm) 포함하여 렌더링
- 텍스트는 패널 경계 내에만 배치

#### 2.2.3 Step 2: Spine

**기능**
- 가수 이름 입력
- 앨범 이름 자동 연동 (Cover에서 가져옴)
- 배경 색상 자동 설정 (Cover 이미지에서 추출)
- 폰트 및 텍스트 색상 설정

**상세 요구사항**
- **데이터 연동**
  - Cover에서 입력한 앨범 이름 자동 전달
  - Cover 이미지에서 추출한 주요 색상을 배경색으로 사용
  - 배경색 대비를 고려한 텍스트 색상 자동 추천
- **텍스트 설정**
  - 가수 이름 필수 입력
  - 앨범 이름은 읽기 전용 (자동 입력 표시)
  - 폰트 설정 (패밀리, 크기, 굵기)
  - 텍스트 색상 선택
- **미리보기**
  - Spine 세로 방향 미리보기
  - 텍스트는 90도 회전하여 표시
  - 줌 인/아웃 기능 (0.5x ~ 3.0x)
  - 줌 리셋 버튼
- **검증**
  - 가수 이름이 입력되어야 다음 단계 진행 가능

**기술 사양**
- Spine 치수: 1.5cm x 10.4cm
- 텍스트는 세로 방향으로 회전하여 렌더링
- 배경색은 Cover에서 추출한 색상 사용

#### 2.2.4 Step 3: Flap

**기능**
- 앨범 이름 자동 연동
- SIDE A 수록곡 리스트 입력
- SIDE B 수록곡 리스트 입력

**상세 요구사항**
- **데이터 연동**
  - Cover에서 입력한 앨범 이름 자동 전달 (읽기 전용)
- **수록곡 입력**
  - SIDE A 수록곡 리스트 입력 (여러 곡)
  - SIDE B 수록곡 리스트 입력 (여러 곡)
  - 각 곡은 줄바꿈 또는 구분자로 분리
  - 곡 추가/삭제 기능
- **미리보기**
  - Flap 세로 방향 미리보기
  - 앨범 이름 (상단 중앙)
  - SIDE A 라벨 및 곡 리스트
  - SIDE B 라벨 및 곡 리스트
  - 곡들은 "•" 구분자로 한 줄 표시
  - 줌 인/아웃 기능 (0.5x ~ 3.0x)
  - 줌 리셋 버튼
- **검증**
  - 수록곡 입력은 선택사항 (빈 상태로도 진행 가능)

**기술 사양**
- Flap 치수: 2.3cm x 10.4cm
- 텍스트는 세로 방향으로 회전하여 렌더링
- 배경색: 흰색

#### 2.2.5 Step 4: Preview (위저드 내부)

**기능**
- Cover, Spine, Flap을 하나의 캔버스에 합성하여 미리보기
- 줌 인/아웃 기능

**상세 요구사항**
- **미리보기**
  - 전체 J카드 레이아웃 표시
  - Flap (좌측) + Spine (중앙) + Cover (우측)
  - Bleed 영역 포함한 전체 크기 표시
  - 줌 인/아웃 기능 (0.5x ~ 3.0x)
  - 줌 리셋 버튼
- **네비게이션**
  - "Flap 수정" 버튼으로 이전 단계로 이동
  - "최종 미리보기 이동" 버튼으로 최종 미리보기 화면으로 이동

**기술 사양**
- 전체 크기: (2.3 + 1.5 + 6.6 + 0.5*2)cm x (10.4 + 0.5*2)cm
- ResizeObserver를 사용하여 컨테이너 크기 변경 감지
- 자동 스케일링 (컨테이너에 맞춤, 최대 1:1)

#### 2.2.6 최종 미리보기 및 다운로드

**기능**
- 완성된 J카드 최종 미리보기
- PNG/JPG 형식으로 다운로드

**상세 요구사항**
- **미리보기**
  - 전체 J카드 레이아웃 표시
  - 고해상도 렌더링 (300 DPI)
  - ResizeObserver를 사용한 반응형 크기 조절
- **다운로드**
  - PNG 형식 다운로드
  - JPG 형식 다운로드 (품질: 0.92)
  - 파일명: `jcard-{timestamp}.{format}`
- **네비게이션**
  - "수정하기" 버튼으로 위저드로 돌아가기

**기술 사양**
- 출력 해상도: 300 DPI
- Bleed 영역 포함한 전체 크기로 렌더링
- 고해상도 Canvas 생성 및 렌더링

---

### 2.3 라벨 스티커 에디터

#### 2.3.1 개요
자동 레이아웃 생성 방식으로 라벨 스티커를 제작

#### 2.3.2 기능

**텍스트 입력**
- 여러 개의 텍스트 입력 필드
- 텍스트 추가/삭제 기능
- 각 텍스트는 독립적으로 입력

**이미지 업로드**
- 최대 3개 이미지 업로드
- 이미지 미리보기 목록 표시
- 이미지 파일명 표시

**자동 레이아웃 생성**
- 텍스트와 이미지를 입력한 후 "자동 생성" 버튼 클릭
- 이미지에서 주요 색상 추출
- 추출된 색상 기반 색상 스킴 생성
- 텍스트와 이미지를 적절한 패널에 자동 배치

**미리보기**
- 생성된 레이아웃 실시간 미리보기
- Canvas 기반 렌더링

**다운로드**
- PNG 형식 다운로드
- JPG 형식 다운로드
- 파일명: `label-{timestamp}.{format}`

#### 2.3.3 레이아웃 구조

**패널 구성**
- Flap: 1.5cm x 10.2cm
- Spine: 1.3cm x 10.2cm
- Main Image: 6.4cm x 10.2cm
- Panel 1: 6.3cm x 10.2cm

**자동 배치 규칙**
- 첫 번째 이미지 → Main Image 패널
- 첫 번째 텍스트 → Main Image 패널 (이미지 위 오버레이)
- 추가 텍스트 → Panel 1 패널 (세로 배치)

---

## 3. 기술 요구사항

### 3.1 기술 스택

**프론트엔드**
- React 19.2.0
- TypeScript 5.9.3
- Vite 7.2.2

**주요 기능**
- Canvas API (렌더링 및 이미지 처리)
- File API (이미지 업로드)
- ResizeObserver API (반응형 레이아웃)

### 3.2 치수 및 해상도

**J카드 치수**
- 전체 크기: 10.4cm x 10.4cm
- Flap (Back Cover): 2.3cm x 10.4cm
- Spine: 1.5cm x 10.4cm
- Cover (Front Cover): 6.6cm x 10.4cm
- Bleed: 0.5cm (각 면)

**라벨 스티커 치수**
- 전체 크기: 15.5cm x 10.2cm
- Flap: 1.5cm x 10.2cm
- Spine: 1.3cm x 10.2cm
- Main Image: 6.4cm x 10.2cm
- Panel 1: 6.3cm x 10.2cm

**출력 해상도**
- DPI: 300
- cm → 픽셀 변환: `(cm / 2.54) * 300`

### 3.3 이미지 처리

**색상 추출**
- Canvas ImageData 분석
- 샘플링 기반 주요 색상 추출
- RGB → HEX 변환

**색상 대비 계산**
- 밝기 계산: `(R*299 + G*587 + B*114) / 1000`
- 밝기 > 128 → 검은색 텍스트
- 밝기 ≤ 128 → 흰색 텍스트

**이미지 리사이징**
- 비율 유지하며 최대 크기에 맞춤
- Cover-fit 방식 (잘리더라도 꽉 차게)

### 3.4 Canvas 렌더링

**고해상도 Canvas 생성**
- 300 DPI 기준 픽셀 크기 계산
- Bleed 영역 포함한 전체 크기
- 메모리 효율적인 렌더링

**텍스트 렌더링**
- 폰트 설정 적용
- 텍스트 줄바꿈 처리
- 그림자 효과 (Cover 텍스트)
- 회전 변환 (Spine, Flap)

**이미지 렌더링**
- 비동기 이미지 로드
- 비율 유지하며 크기 조절
- 클리핑 영역 설정

### 3.5 파일 다운로드

**형식 지원**
- PNG (무손실)
- JPG (품질 0.92)

**다운로드 메커니즘**
- Canvas → DataURL 변환
- `<a>` 태그를 통한 다운로드 트리거
- 타임스탬프 기반 파일명 생성

---

## 4. 사용자 인터페이스

### 4.1 화면 구성

**메인 화면 (템플릿 선택)**
- 헤더: 제목 및 부제목
- 템플릿 그리드: J카드, 라벨 스티커 카드

**J카드 위저드**
- 상단: 뒤로 버튼, 단계 인디케이터 (1-4)
- 좌측: 입력 폼 (사이드바)
- 우측: 실시간 미리보기

**라벨 에디터**
- 상단: 뒤로 버튼, 제목, 다운로드 버튼
- 좌측: 입력 폼 (사이드바)
- 우측: 미리보기

### 4.2 UI 컴포넌트

**공통 컴포넌트**
- `TextInput`: 텍스트 입력 필드
- `ImageUpload`: 이미지 업로드 드롭존
- `FontSelector`: 폰트 선택기
- `ColorSelector`: 색상 선택기
- `TrackListInput`: 수록곡 리스트 입력
- `CanvasPreview`: Canvas 미리보기

**J카드 전용 컴포넌트**
- `CassetteCoverEditor`: Cover 에디터
- `SpineEditor`: Spine 에디터
- `FlapEditor`: Flap 에디터
- `JCardPreviewStep`: 위저드 내부 미리보기
- `JCardPreview`: 최종 미리보기

### 4.3 스타일링

**CSS 모듈**
- 각 컴포넌트별 CSS 파일
- 반응형 레이아웃
- 모던한 UI 디자인

---

## 5. 데이터 모델

### 5.1 JCardData

```typescript
interface JCardData {
  cover: CassetteCoverData;
  spine: SpineData;
  flap: FlapData;
}
```

**CassetteCoverData**
- `image`: File | null
- `albumName`: string
- `font`: FontSettings
- `textColor`: string
- `dominantColor?`: string (이미지에서 추출)

**SpineData**
- `artistName`: string
- `albumName`: string
- `backgroundColor`: string
- `font`: FontSettings
- `textColor`: string

**FlapData**
- `albumName`: string
- `sideA`: string[]
- `sideB`: string[]

**FontSettings**
- `family`: string
- `size`: number
- `weight`: 'normal' | 'bold' | '300' | '400' | '500' | '600' | '700'

### 5.2 EditorState (라벨 에디터)

```typescript
interface EditorState {
  type: 'label';
  texts: TextElement[];
  images: ImageElement[];
  colorScheme: ColorScheme;
  selectedElementId: string | null;
}
```

---

## 6. 성능 요구사항

### 6.1 이미지 처리
- 대용량 이미지도 효율적으로 처리
- 메모리 누수 방지 (URL.revokeObjectURL)
- 비동기 이미지 로드

### 6.2 Canvas 렌더링
- ResizeObserver를 통한 효율적인 리사이즈 처리
- 고해상도 렌더링 시 성능 최적화
- 메모리 관리

### 6.3 사용자 경험
- 실시간 미리보기 반응 속도 < 100ms
- 이미지 업로드 즉시 처리
- 다운로드 파일 생성 시간 < 2초

---

## 7. 제한사항 및 고려사항

### 7.1 브라우저 호환성
- Canvas API 지원 브라우저
- File API 지원 브라우저
- ResizeObserver API 지원 브라우저

### 7.2 파일 크기
- 업로드 가능한 이미지 크기 제한 없음 (브라우저 메모리 제한 내)
- 다운로드 파일 크기는 해상도에 따라 수십 MB 가능

### 7.3 데이터 저장
- 현재 버전에서는 로컬 저장 기능 없음
- 새로고침 시 입력 데이터 손실

### 7.4 인쇄 품질
- 300 DPI 기준으로 최적화
- 실제 인쇄 시 프린터 설정에 따라 결과물 차이 가능

---

## 8. 향후 개선 사항

### 8.1 기능 개선
- 템플릿 저장/불러오기
- 사용자 정의 템플릿 생성
- 더 많은 폰트 옵션
- 이미지 필터 및 효과
- 텍스트 정렬 옵션 (좌/중앙/우)

### 8.2 사용자 경험
- 드래그 앤 드롭으로 요소 위치 조정
- 실시간 협업 기능
- 히스토리/되돌리기 기능
- 반응형 모바일 지원

### 8.3 기술 개선
- 서버 사이드 렌더링 지원
- 클라우드 저장소 연동
- 소셜 공유 기능
- 인쇄 주문 연동

---

## 9. 용어 정의

- **J카드**: 카세트 테이프 케이스에 삽입되는 종이 커버
- **Spine**: J카드의 등 부분 (세로로 텍스트 표시)
- **Flap**: J카드의 뒷면 부분 (수록곡 리스트 표시)
- **Cover**: J카드의 앞면 부분 (메인 이미지 및 앨범 이름)
- **Bleed**: 인쇄 시 잘릴 수 있는 여유 영역 (일반적으로 0.5cm)
- **DPI**: Dots Per Inch, 인쇄 해상도 단위
- **라벨 스티커**: 카세트 테이프 본체에 붙이는 스티커

---

## 10. 참고 사항

### 10.1 프로젝트 구조
```
src/
├── components/        # React 컴포넌트
├── types/            # TypeScript 타입 정의
├── utils/            # 유틸리티 함수
└── App.tsx           # 메인 앱 컴포넌트
```

### 10.2 주요 유틸리티
- `dimensions.ts`: 치수 계산 및 변환
- `imageProcessor.ts`: 이미지 처리 및 색상 추출
- `jcardGenerator.ts`: J카드 Canvas 렌더링
- `canvasExporter.ts`: Canvas 다운로드
- `autoLayout.ts`: 자동 레이아웃 생성

---

**문서 버전**: 1.0  
**작성일**: 2024  
**최종 수정일**: 2024

